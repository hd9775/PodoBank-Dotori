## 🐿️ 도토리

### 1. 기획배경
소비습관 개선을 위해 사용 계획과 저축 목표를 생성하고, 이를 은행과 연결하여 기간별, 카테고리별 소비패턴 확인으로 소비습관을 개선하고 목표를 이룰 수 있는 로직을 구현했습니다.


<hr>


### 2. 주요기능설명

| 계좌등록 | 계획생성 1 | 계획생성 2 | 계획생성 3 |
|-------|-------|-------|-------|
|![Dotori_account_add](https://github.com/tlalswn23/Algorithm/assets/35682216/17b963c4-20c3-478b-9166-d843c728308f) | ![plan_create1](https://github.com/tlalswn23/Algorithm/assets/35682216/10b0508f-a506-467c-93f1-8d99f83fa9f8) | ![plan_create2](https://github.com/tlalswn23/Algorithm/assets/35682216/ad776d90-c92f-4c28-bcec-c62068201859) | ![plan_create3](https://github.com/tlalswn23/Algorithm/assets/35682216/5cf71fc0-feb1-4b24-bdb6-b5684331c875) |
<br>

| 계획조회 | 목표등록 | 계획종료&저축&리워드 | 명세서조회 |
|-------|-------|-------|-------|
| ![plan_info](https://github.com/tlalswn23/Algorithm/assets/35682216/2e4ce6a0-d91d-434b-a452-9084f5b26d24) |![Dotori_purpose_add](https://github.com/tlalswn23/Algorithm/assets/35682216/be3cc203-07d7-458e-9c45-029c4434842b) | ![Dotori_plan_finish](https://github.com/tlalswn23/Algorithm/assets/35682216/614579df-1598-4286-8aba-f354da555cf6) | ![Dotori_specification](https://github.com/tlalswn23/Algorithm/assets/35682216/e7441ad2-7fe2-4371-989c-af2a7f227a5a) |
<br>

- 1원 인증 : '도토리'에서 1원 인증을 위해 계좌를 입력하면, '포도은행'으로 송금자명이 4자리 숫자 명칭으로 송금되어, 이 4자리 숫자를 해당 계좌에서 확인하고 '도토리'에서 입력함으로 인증 절차 완료
- 계좌 연결 : '도토리'에 '포도은행'과 연결된 계좌의 정보를 받아옴으로 '도토리'에서 소비패턴을 분석할 수 있게 함
- 계획 설정 : 연결된 계좌 당 한 번에 하나의 계획을 만들어서 그 안에서 각 카테고리를 생성하여 계획 설정 후, 카테고리별 소비패턴을 확인할 수 있음. 계획이 완료되면, 저축하기를 통해 목표에 저축함.
- 카테고리 등록 : Chat GPT를 이용해서 사용자가 등록한 카테고리를 대분류에서 분류시킴
- 목표 설정 : 저축 목표를 설정하고 이를 완료된 계획을 통해 저축할 수 있게 함
- 명세서 보기: 완료된 계획들을 정리해 보도록 하며, 등록한 카테고리별 소비패턴을 확인하게 함
- 리워드 : 계획이 정상적으로 종료되면, 도토리 1개를 제공하며, 도토리 10개가 모이면 코인이 1개가 제공됨. 이 코인을 통해 랜덤박스를 개봉하여, 1~1000원 사이의 금액 중 무작위 금액을 받은 후 연결된 계좌로 이체 가능

<hr>


### 3. ERD
![image](https://github.com/Poposong/WebRTC/assets/81174840/16d7f723-002d-4cc7-977b-3c6cbff748a6)

<hr>


### 4. API

| Type          | Method | Entry Point                          | Description                              | Role  | Request                                                                                                            | Response Code |
|---------------|--------|-------------------------------------|------------------------------------------|-------|--------------------------------------------------------------------------------------------------------------------|---------------|
| USERS         | POST   | /v1/user/email/check-code           | 회원가입의 이메일 인증코드 확인           | ALL   | { "id" : { "type" : "string" }, "code" : { "type" : "string" } }                                                   | { "200" : "이메일 인증 완료", "409" : "인증번호가 올바르지 않습니다.", "404" : "인증번호가 만료되었습니다." } |
| USERS         | POST   | /v1/user/email/check-id             | 회원가입의 이메일 인증                 | ALL   | id                                                                                                                 | { "409" : "이미 존재하는 사용자입니다.", "200" : "이메일 인증코드 전송" }               |
| USERS         | POST   | /v1/user/new-token                  | 새로운 토큰 발급                       | ALL   | { "refreshToken" : { "type" : "string" } }                                                                      | { "200" : "토큰 재발급 성공", "404" : "다시 로그인 해주세요." } Response Data { "grantType" : { "type" : "string" }, "accessToken" : { "type" : "string" }, "refreshToken" : { "type" : "string" } }                                                |
| USERS         | POST   | /v1/user/signin                    | 도토리 로그인                          | ALL   | { "id" : { "type" : "string" }, "password" : { "type" : "string" } }                                               | { "200" : "로그인 성공", "404" : "아이디를 확인해주세요." }                                |
|               |        |                                     |                                          |       | { "grantType" : { "type" : "string" }, "accessToken" : { "type" : "string" }, "refreshToken" : { "type" : "string" } } |                                               |
| USERS         | POST   | /v1/user/signup                    | 사용자 회원가입                        | ALL   | { "id" : { "type" : "string" }, "password" : { "type" : "string" }, "userName" : { "type" : "string" }, "birthDate" : { "type" : "string" }, "phoneNumber" : { "type" : "string" } } | { "200" : "회원가입을 완료했습니다.", "400" : "회원가입에 실패했습니다." }                    |
| USERS         | GET    | /v1/user                           | 사용자 데이터 가져오기                 | USER  |                                                                                                                    | { "200" : "사용자의 데이터를 가져오는데 성공함" } Response Data  { "userSeq" : { "type" : "integer", "format" : "int64" }, "id" : { "type" : "string" }, "birthDate" : { "type" : "string", "format" : "date" }, "userName" : { "type" : "string" }, "phoneNumber" : { "type" : "string" }, "authProvider" : { "type" : "string", "enum" : [ "KAKAO", "NAVER", "DOTORI" ] } } |
| USERS         | PATCH  | /v1/user/birthDate                 | 사용자의 생년월일 업데이트             | USER  | { "birthDate" : { "type" : "string" } }                                                                         | { "200" : "사용자의 생년월일 업데이트 완료" }                                       |
| USERS         | PATCH  | /v1/user/logout                    | 사용자 로그아웃                        | USER  |                                                                                                                    | { "200" : "사용자 로그아웃 완료" }                                                     |
| USERS         | PATCH  | /v1/user/password                  | 사용자의 비밀번호 업데이트             | USER  | { "beforePassword" : { "type" : "string" }, "afterPassword" : { "type" : "string" } }                              | { "404" : "비밀번호를 확인해주세요.", "403" : "네이버, 카카오 로그인은 비밀번호를 변경할 수 없습니다.", "200" : "사용자 비밀번호 변경 완료" } |
| USERS         | PATCH  | /v1/user/phoneNumber               | 사용자의 헨드폰번호 업데이트           | USER  | { "phoneNumber" : { "type" : "string" } }                                                                       | { "200" : "사용자의 헨드폰번호 업데이트 완료" }                                      |
| USERS         | PATCH  | /v1/user/retire                    | 사용자 탈퇴하기                        | USER  |                                                                                                                    | { "200" : "사용자 탈퇴 완료" }                                                       |
| PURPOSE       | POST   | /v1/purpose                        | 새로운 목표 생성                      | ALL   | { "purposeTitle" : { "type" : "string" }, "goalAmount" : { "type" : "number" }, "startedAt" : { "type" : "string", "format" : "date" }, "endAt" : { "type" : "string", "format" : "date" } } | { "200" : "목표 생성 성공" }                                                             |
| PURPOSE       | GET    | /v1/purpose/{purposeSeq}            | 목표 상세 조회                         | ALL   | purposeSeq                                                                                                         | { "200" : "목표 상세 조회 성공" } Response Data { "purposeTitle" : { "type" : "string" }, "currentBalance" : { "type" : "number" }, "goalAmount" : { "type" : "number" }, "startedAt" : { "type" : "string" }, "endAt" : { "type" : "string" }, "purposeDataList" : { "type" : "array", "items" : { "$ref" : "#/components/schemas/PurposeDataDTO" } } } |
| PURPOSE       | GET    | /v1/purpose/terminate/{purposeSeq} | 목표 진행 현황                        | ALL   | purposeSeq                                                                                                         | { "200" : "목표 진행 현황 반환 성공" } Response Data { "purposeTitle" : { "type" : "string" }, "goalAmount" : { "type" : "number" }, "currentBalance" : { "type" : "number" }, "restAmount" : { "type" : "number" }, "percentage" : { "type" : "number" } } |
| PURPOSE       | GET    | /v1/purpose                        | 전체 목표 리스트 조회                   | ALL   |                                                                                                                    | { "200" : "목표 리스트 조회 성공" }                                                    |
|               |        |                                     |                                          |       | { "currentTotalSavings" : { "type" : "number" }, "purposeList" : { "type" : "array", "items" : { "$ref" : "#/components/schemas/PurposeListDTO" } } } |                                               |
| PURPOSE       | PATCH  | /v1/purpose/terminate/{purposeSeq}  | 목표 중단                             | ALL   | purposeSeq                                                                                                         | { "200" : "목표 중단 성공" }                                                         |
| CHATGPT       | POST   | /v1/chatgpt                       | 카테고리그룹에 따라 카테고리 분류    | ALL   | { "categoryGroups" : { "type" : "array", "items" : { "type" : "string" } }, "categorise" : { "type" : "array", "items" : { "$ref" : "#/components/schemas/ActiveCategoryDTO" } } } | { "200" : "카테고리 분류 성공" } Response Data { "categoryGroupName" : { "type" : "string" }, "categories" : { "type" : "array", "items" : { "$ref" : "#/components/schemas/ActiveCategoryDTO" } } } |
| CHATGPT       | GET    | /v1/chatgpt/unclassified           | 카테고리에 따라 payment 분류         | ALL   |                                                                                                                    | { "200" : "payment 분류 성공" }                                                       |
| USERAUTH      | POST   | /v1/auth/account/title              | 계좌의 이름 설정하기                   | USER  | { "accountNumber" : { "type" : "string" }, "accountTitle" : { "type" : "string" } }                                | { "200" : "계좌이름 설정 완료" }                                                     |
| USERAUTH      | POST   | /v1/auth/own/check-code             | [1원 인증의 본인인증] 인증코드 확인하기 | USER  | { "id" : { "type" : "string" }, "code" : { "type" : "string" } }                                                   | { "409" : "인증번호가 올바르지 않습니다.", "404" : "인증번호가 만료되었습니다.", "200" : "1원인증 완료" } |
| USERAUTH      | POST   | /v1/auth/own/check-id               | [1원 인증의 본인인증] 사용자 이메일에 인증번호 보내기 | USER | id                                                                                                                 | { "404" : "사용자의 정보의 이메일과 정보가 일치하지 않습니다." } |
| USERAUTH      | POST   | /v1/auth/podoBank/check-account     | [포도은행에서 1원 인증] 포도은행에서 계좌의 존재 여부 확인한 후 1원 인증 요청하기 | USER | { "bankSeq" : { "type" : "integer", "format" : "int64" }, "accountNumber" : { "type" : "string" } } | { "404" : "포도은행에 1원 인증 실패", "200" : "포도은행에 1원 인증 성공" } |
| USERAUTH      | POST   | /v1/auth/podoBank/check-code       | [포도은행에서 1원 인증] 포도은행에 1원 인증코드 검사하기 | USER | { "bankSeq" : { "type" : "integer", "format" : "int64" }, "accountNumber" : { "type" : "string" }, "verificationCode" : { "type" : "string" } } | { "200" : "인증 코드 일치", "404" : "1원 인증 실패" } |
| NAVER         | GET    | /v1/naver/callback                  | 네이버 회원가입/로그인                 | ALL   |                                                                                                                    | { "200" : "네이버 회원가입 성공", "201" : "네이버 로그인 성공", "403" : "네이버 인증에 실패했습니다." } Response Data { "grantType" : { "type" : "string" }, "accessToken" : { "type" : "string" }, "refreshToken" : { "type" : "string" } } |
| KAKAO         | GET    | /v1/kakao/callback                  | 카카오 회원가입/로그인                 | ALL   |                                                                                                                    | { "200" : "카카오 회원가입 성공", "201" : "카카오 로그인 성공", "403" : "카카오 인증에 실패했습니다." } Response Data { "grantType" : { "type" : "string" }, "accessToken" : { "type" : "string" }, "refreshToken" : { "type" : "string" } } |
| CATEGORYGROUP | GET    | /v1/categoryGroup/                  | 카테고리 그룹 리스트 조회               | ALL   |                                                                                                                    | { "200" : "카테고리 그룹 리스트 조회 성공" } Response Data { "categoryGroupSeq" : { "type" : "integer", "format" : "int64" }, "groupTitle" : { "type" : "string" } } |
| CATEGORYDATA  | GET    | /v1/categoryData                    |                                      | ALL   | categorySeq                                                                                                         | { }                                           |
|               | DELETE | /v1/categoryData                    |                                      | ALL   | categoryDataSeq                                                                                                     | { }                                           |
| CATEGORY      | GET    | /v1/category/                       | 카테고리 리스트 조회                   | ALL   |                                                                                                                    | { "200" : "카테고리 리스트 조회 성공" } Response Data { "categorySeq" : { "type" : "integer", "format" : "int64" }, "categoryTitle" : { "type" : "string" }, "categoryGroup" : { "type" : "integer", "format" : "int64" } } |
| BANK          | GET    | /v1/bank                           |                                      | ALL   |                                                                                                                    | { }                                           |
| ACCOUNT       | GET    | /v1/account                        | 전체 계좌 조회                         | ALL   |                                                                                                                    | { "200" : "전체 계좌 조회 성공" }  { "accountSeq" : { "type" : "integer", "format" : "int64" }, "accountTitle" : { "type" : "string" }, "currentBalance" : { "type" : "number" } } |
| PLAN          | POST   | /v1/plan/saving                    | 저축하기                               | ALL   | { "planSeq" : { "type" : "integer", "format" : "int64" }, "purposeSavingList" : { "type" : "array", "items" : { "$ref" : "#/components/schemas/PurposeSavingDTO" } }, "totalSaving" : { "type" : "number" } } | { "200" : "저축 성공" }                                                               |
| PLAN          | POST   | /v1/plan                          | 새로운 계획 등록                       | ALL   | { "accountSeq" : { "type" : "integer", "format" : "int64" }, "startedAt" : { "type" : "string" }, "endAt" : { "type" : "string" }, "categoryGroupList" : { "type" : "array", "items" : { "$ref" : "#/components/schemas/CategoryGroupListDTO" } } } | { "200" : "계획 생성 성공" }                                                         |
| PLAN          | GET    | /v1/plan/specification             | 전체 명세서 불러오기                   | ALL   |                                                                                                                    | { "200" : "전체 명세서 조회" }                                                         |
|               |        |                                     |                                          |       | { "planSeq" : { "type" : "integer", "format" : "int64" }, "startAt" : { "type" : "string" }, "endAt" : { "type" : "string" } } |                                               |
| PLAN          | GET    | /v1/plan/{accountSeq}              | 계좌에 연결된 실행중인 계획 조회     | ALL   | accountSeq                                                                                                         | { "200" : "실행 중인 계획 조회 성공" }                                              |
|               |        |                                     |                                          |       | { "accountBalance" : { "type" : "number" }, "startedAt" : { "type" : "string", "format" : "date-time" }, "endAt" : { "type" : "string", "format" : "date-time" }, "terminatedAt" : { "type" : "string", "format" : "date-time" }, "state" : { "type" : "string", "enum" : [ "READY", "ACTIVE", "INACTIVE", "COMPLETED", "SAVED" ] }, "planSeq" : { "type" : "integer", "format" : "int64" }, "unclassified" : { "type" : "integer", "format" : "int64" }, "activePlanList" : { "type" : "array", "items" : { "$ref" : "#/components/schemas/ActivePlanDetailDTO" } } } |                                               |
| PLAN          | PATCH  | /v1/plan/complete                  | 계획 상태 변경                         | ALL   | { "planSeq" : { "type" : "integer", "format" : "int64" } }                                                         | { "200" : "COMPLETED 상태 변경 성공" }                                               |
| PLAN          | PATCH  | /v1/plan/stop/{planSeq}            | 실행중인 계획 중단                   | ALL   | planSeq                                                                                                            | { "200" : "계획 중단 성공" }                                                        |
| PAYMENT       | POST   | /v1/payment/listAll                |                                      | ALL   | { "accountSeq" : { "type" : "integer", "format" : "int64" }, "planSeq" : { "type" : "integer", "format" : "int64" } } | { }                                           |
| PAYMENT       | GET    | /v1/payment/{planSeq}              | 미분류 Payment 리스트 조회             | ALL   | planSeq                                                                                                            | { "200" : "미분류 내역 조회" }                                                        |
|               |        |                                     |                                          |       | { "planDetailSeq" : { "type" : "integer", "format" : "int64" }, "categoryName" : { "type" : "string" }, "paymentSeq" : { "type" : "integer", "format" : "int64" }, "paymentName" : { "type" : "string" }, "paymentPrice" : { "type" : "number" }, "paymentDate" : { "type" : "string" } } |                                               |
| PAYMENT       | PATCH  | /v1/payment/{planSeq}              | 미분류 Payment category 수정 확인      | ALL   | planSeq{ "updateData" : { "type" : "array", "items" : { "$ref" : "#/components/schemas/UpdateDataDTO" } } } | { "200" : "미분류 사용자 확인" }                                                     |
| PLANDETAIL    | GET    | /v1/planDetail/specification/{planSeq} | 명세서 상세 조회                   | ALL   |                                                                                                                    | { "200" : "명세서 상세 조회 성공" } Response Data { "categoryTitle" : { "type" : "string" }, "purposeSavingList" : { "type" : "array", "items" : { "$ref" : "#/components/schemas/PurposeSavingDTO" } }, "totalSaving" : { "type" : "number" }, "planSeq" : { "type" : "integer", "format" : "int64" }, "categoryGroupList" : { "type" : "array", "items" : { "$ref" : "#/components/schemas/CategoryGroupListDTO" } } } |
| PURPOSESAVING | POST   | /v1/purposeSaving                  | 목표 저축 내역 추가                   | ALL   | { "purposeSeq" : { "type" : "integer", "format" : "int64" }, "categoryGroupSeq" : { "type" : "integer", "format" : "int64" }, "amount" : { "type" : "number" }, "categorySeq" : { "type" "integer", "format" : "int64" } } | { "200" : "목표 저축 내역 추가 성공" }                                                |
| UPDATEUSER    | PATCH  | /v1/updateUser/phoneNumber         | 사용자의 전화번호 업데이트             | USER  | { "phoneNumber" : { "type" : "string" } }                                                                       | { "200" : "사용자의 전화번호 업데이트 완료" }                                        |
| PAYMENTDETAIL | GET    | /v1/paymentDetail/{planSeq}        | Payment 상세 조회                      | ALL   | { "planDetailSeq" : { "type" : "integer", "format" : "int64" } }                                                 | { "200" : "Payment 상세 조회 성공" }                                                 |
| UPDATEUSER    | PATCH  | /v1/updateUser/userName            | 사용자의 이름 업데이트                 | USER  | { "userName" : { "type" : "string" } }                                                                           | { "200" : "사용자의 이름 업데이트 완료" }                                            |


